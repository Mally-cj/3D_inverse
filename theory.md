````markdown name=高精度方位各向异性参数反演方法进展.md
# 1.1 方位各向异性参数高精度反演方法研究

## 进展一

### （一）形成物理知识引导的半监督深度学习阻抗反演框架

地震声波阻抗反演在地震勘探中发挥着至关重要的作用，其在地震数据和定量地质之间架起了一座连接的桥梁。声波阻抗反演可以从叠后地震数据中推断声波阻抗，有利于预测地层岩性参数，例如孔隙度等，以实现储层预测。到目前为止，研究人员已经提出了各种反演方法来获得高精度的声波阻抗。本研究针对目前已有深度学习反演方法受标签数据影响，且需给定地震子波的局限性，提出物理知识引导的半监督深度学习阻抗反演方法。原理简介如下：

基于经典褶积模型，地震道可以表示为：

$$
y = W D(z) + n \quad (4.15-1)
$$

式中，$y$表示地震数据，$W$表示由地震子波生成的Toeplitz矩阵，$D$表示差分算子，$z$表示阻抗，$n$表示随机噪音。为了求解该反演问题，通常最小化如下形式的损失函数：

$$
J = \| y - W D(z) \|_2^2 + \lambda G(z) \quad (4.15-2)
$$

式中，$G$表示正则化约束项，$\lambda$表示正则化参数。在对公式(4.15-2)求解过程中，研究人员需要给定地震子波，以生成矩阵$W$，同时需要给定显式的正则化项与固定的正则化参数，这无疑增加了人工成本，且难以获得高精的阻抗反演结果。为此，本研究引入深度学习来解决上述局限性。

首先，为了避免地震子波与阻抗之间的耦合作用，本项目首先利用地震数据与井数据对地震子波进行估计。首先对地震子波振幅谱进行平滑获取初始零相位地震子波，之后利用一个卷积神经网络对初始零相位子波进行校正，以估计准确的地震子波。计算过程可以表示为如下形式：

$$
W = T_q(w_0) + w_0 \quad (4.15-3)
$$

式中，$w_0$表示初始零相位地震子波，$T_q$表示深度卷积神经网络。为了对网络参数进行更新，建立如下形式的损失函数：

$$
J = \frac{1}{N} \left\| \left( T_q(w_0) + w_0 \right) * r_{\log} - Moy \right\|_2^2
$$

式中，$\log$表示由测井数据计算的反射系数，$*$表示卷积运算，$M$表示掩码矩阵，即有井位置的值为1，无井位置为0。但考虑到数据的空间连续性，可以将$M$设置为与井数据距离相关的权重算子。通过最小化上述公式，即可完成子波网络的训练。

地震子波估计之后，我们需要从地震数据中估计地震声波阻抗。基于U-Net在求解反演问题方面的出色表现，本项目利用U-Net学习地震数据与阻抗之间的映射关系。但由于叠后地震数据中通常缺少低频信息，如果仅依赖网络去学习绝对阻抗，反演精度较差，且无法充分捕获低频趋势。基于此，考虑到实际中有许多研究可以获得较可靠的低频信息，因此本项目将低频信息作为已知量。此外，地震数据到阻抗之间的反演是数据空间到模型空间的映射，这往往会增加反演问题的多解性。因此，为了改善网络的反演精度，且提高网络的泛化性，本项目将最小二乘解作为网络输入，利用U-Net去学习模型空间到模型空间的映射。该过程具体可以表示为：

$$
z = L_q(y, z_0) + z_0 \quad (4.15-5)
$$

式中，$z_0$为最小二乘解，地震数据$y$的进一步利用是为了减少最小二乘解带来的不可逆损失。为了更新网络参数，本项目设计如下形式的半监督损失函数：

$$
\begin{aligned}
J = & \frac{1}{K} \left\| D \left( L_q(y, z_0) + z_0 \right) * W - y \right\|_2^2 \\
& + \frac{u}{N} \left\| Mo \left( L_q(y, z_0) + z_0 \right) - z_{\log} \right\|_2^2 \\
& + t \left\| L_q(y, z_0) + z_0 \right\|_{tv}
\end{aligned}
$$

该公式中主要包括三项，第一项是无监督损失，第二项是有监督损失，第三项增加了对阻抗的全变分约束，以进一步提高网络的预测性能。通过最小化上述公式即可实现声波阻抗反演网络的训练。

### （二）方法测试与验证

为了对所研究方法进行验证，利用一个3D模型对方法进行测试。假设该测试工区有6口井数据，对该6口井进行插值并进行低通滤波，得到初始低频背景。为了增加训练数据集，从已有的6口井中随机选取3口形成多个联井剖面，然后用于网络训练。之后，利用网络对整个3D模型正演的地震数据进行预测。图4.15-1展示了两个Inline剖面的反演结果，通过观察发现，所提方法利用6口井可以实现阻抗的高分辨预测，且准确刻画阻抗的横向展布。图4.15-2展示了两个时间切片，反演结果同样验证所提方法可以实现对河道以及滩的准确刻画。
````